---
title: "Solr9ã®kuromojiã§UniDic3.1.1ã‚’ä½¿ã†"
emoji: "ğŸŒ„"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["solr", "lucene"]
published: false
---

## æ¦‚è¦

Solr9.1ã®kuromojiã§UniDic3.1.1ã‚’(ç„¡ç†ã‚„ã‚Š)ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

[UniDic](https://clrd.ninjal.ac.jp/unidic/)ã¯å›½ç«‹å›½èªç ”ç©¶æ‰€ã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚ŒãŸã€å½¢æ…‹ç´ è§£æå™¨MeCabç”¨ã®è§£æç”¨è¾æ›¸ã§ã™ã€‚
å½¢æ…‹ç´ è§£æç”¨è¾æ›¸ã«ã¯IPA(IPADic)ã‚„NAISTè¾æ›¸ã€NEologdè¾æ›¸ãªã©ãŒã‚ã‚Šã¾ã™ãŒã€IPAè¾æ›¸ã¯2007å¹´ã§ã€NAISTè¾æ›¸ã¯2011å¹´ã§ã€NEologdè¾æ›¸ã¯2020å¹´ã§æ›´æ–°ãŒåœæ­¢ã—ã¦ã„ã¾ã™ã€‚UniDicã¯2022å¹´9æœˆã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³3.1.1ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ãŠã‚Šã€2022å¹´ç¾åœ¨ã§ã‚‚æ›´æ–°ãŒç¶šã„ã¦ã„ã‚‹æ•°å°‘ãªã„è¾æ›¸ã§ã™ã€‚

ã›ã£ã‹ããªã®ã§æ–°ã—ã„è¾æ›¸ã‚’ä½¿ã„ãŸã„ã€ã¨æ€ã£ãŸã®ã§ã™ãŒã€æ­£å¼ã«ã¯ã¾ã å¯¾å¿œã—ã¦ã„ãªã„ã‚ˆã†ã§ã—ãŸ(ãã‚‚ãã‚‚å¤§æœ¬ã®atilika/kuromojiãŒ[UniDic2.1.2ã¾ã§ã«ã—ã‹å¯¾å¿œã—ã¦ã„ãªã„](https://github.com/atilika/kuromoji#supported-dictionaries)...)ã€‚

ã—ã‹ã—ã€ãªã‚“ã‚„ã‹ã‚“ã‚„è©¦ã—ã¦ã¿ã‚‹ã¨ãƒ“ãƒ«ãƒ‰ãŒã™ã‚“ãªã‚Šé€šã£ã¦ã—ã¾ã„ã€å½¢æ…‹ç´ è§£æã®å‹•ä½œç¢ºèªã‚‚ã§ãã¦ã—ã¾ã„ã¾ã—ãŸã€‚
å†…å®¹çš„ã«ã¯[ã“ã¡ã‚‰ã®ã‚¨ãƒ³ãƒˆãƒª](https://blog.johtani.info/blog/2019/12/04/about-lucene-4056/)ãã®ã¾ã¾ã§ã™ãŒã€Lucene9ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ãŒApache Antã‹ã‚‰Gradleã«å¤‰æ›´ã«ãªã£ãŸã“ã¨ã§å…ˆäººã®çŸ¥æµãŒãã®ã¾ã¾é©ç”¨ã§ããªã‹ã£ãŸã‚Šã—ãŸã®ã§ã€è¦šæ›¸ã¨ã„ã†ã“ã¨ã§ã“ã®è¨˜äº‹ã‚’æ›¸ãã¾ã—ãŸã€‚

## æ³¨æ„æ›¸ã

ã“ã‚Œã‚’æ›¸ã„ãŸäººã¯Solr/Luceneã‚„å½¢æ…‹ç´ è§£æå™¨ã®çŸ¥è­˜ã¯ãŠã‚ã‹Javaã®çŸ¥è­˜ã™ã‚‰æŒã¡åˆã‚ã›ã¦ã„ãªã„ç´ äººã§ã™ã€‚èª¤ã£ãŸè¨˜è¿°ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
ã¾ãŸã€ã“ã®æ‰‹é †ã«ã‚ˆã£ã¦ä½œã£ãŸè¾æ›¸ã¯ç„¡ç†ã‚„ã‚Šãƒ“ãƒ«ãƒ‰ã—ãŸã‚‚ã®ã§ã‚ã‚Šã€è¾æ›¸ã®æ•´åˆæ€§ãŒä¿ãŸã‚Œã¦ã„ã‚‹ä¿è¨¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚

## ç’°å¢ƒ

- Ubuntu 22.04
- openjdk 11.0.17 2022-10-18
- Solr 9.1.0
- Lucene 9.3.0

## æ‰‹é †

### Solrã¨Javaã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Java11ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚Ubuntuã®å ´åˆã€`apt`ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```bash
sudo apt install openjdk-11-jdk
```

Solrå…¬å¼ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«å¾“ã£ã¦Solr9.1ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

- [Installing Solr](https://solr.apache.org/guide/solr/latest/deployment-guide/installing-solr.html)
- [Installation Requirements](https://solr.apache.org/guide/solr/latest/deployment-guide/system-requirements.html)

é€šå¸¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã†ã‹ã€ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‹ã¯å•ã„ã¾ã›ã‚“ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚‰ã€8983ç•ªãƒãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããŸã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚ã€‚

ã“ã“ã§ã€æ—¥æœ¬èªãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ã‚’ä½¿ç”¨ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚¿ã‚¤ãƒ—ã‚’æŒã£ãŸã‚³ã‚¢ã‚’ä½œã£ã¦ãŠãã¾ã—ã‚‡ã†ã€‚
ã‚³ã‚¢ã‚’ä½œã‚‹ã®ãŒé¢å€’ãªã‚‰ã€Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ä½¿ã£ã¦Solrç’°å¢ƒã‚’ä½œã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•æ™‚ã®ã‚³ãƒãƒ³ãƒ‰ã«`solr-precreate example`ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€exampleã‚³ã‚¢ãŒä½œã‚‰ã‚ŒãŸçŠ¶æ…‹ã®Solrã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ã¾ã™ã€‚
ã“ã®ã‚³ã‚¢ã®ä¸­ã«`text_ja`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚¿ã‚¤ãƒ—ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã®ã§ã€ã™ãã«å‹•ä½œç¢ºèªã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

### Luceneã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

[Luceneã®GitHubãƒªãƒã‚¸ãƒˆãƒª](https://github.com/apache/lucene)ã‹ã‚‰9.3.0ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¾ã™ã€‚
ãƒªãƒã‚¸ãƒˆãƒªã®ã‚µã‚¤ã‚ºãŒéå¸¸ã«å¤§ãã„ã®ã§ã€ã‚·ãƒ£ãƒ­ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

```bash
git clone https://github.com/apache/lucene.git --branch releases/lucene/9.3.0 --depth 1
```

### ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´

Luceneã®ã„ãã¤ã‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¾ã™ã€‚å¤‰æ›´ç®‡æ‰€ã¯[ã“ã¡ã‚‰ã®ã‚¨ãƒ³ãƒˆãƒª](https://blog.johtani.info/blog/2019/12/04/about-lucene-4056/)ã¨ã»ã¨ã‚“ã©åŒã˜ã§ã™ã€‚

#### `kuromoji.gradle`

æ—¢å­˜ã®`compileMecab`ã¨`compileNaist`ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã—ã€æ–°ãŸã«`compileUnidic`ã‚¿ã‚¹ã‚¯ã‚’å®šç¾©ã—ã¾ã™ã€‚
ã‚¿ã‚¹ã‚¯ã®å®šç¾©å†…å®¹ã¯ä»–ã®2ã¤ã¨ã»ã¨ã‚“ã©å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚å¤‰æ›´ç‚¹ã¯ä»¥ä¸‹ã®3ç‚¹ã§ã™ã€‚

1. è¾æ›¸ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URL
2. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸè¾æ›¸ã‚’å±•é–‹ã™ã‚‹å‡¦ç†ã‚’`untar`ã‹ã‚‰`unzip`ã¸
3. å…¥åŠ›ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’`utf-8`ã¸

æ›´ã«ã€æœ€ä¸‹éƒ¨ã®è¡Œã‚’`regenerate.dependsOn compileUnidic`ã«å¤‰æ›´ã—ã¾ã™ã€‚

```gradle:gradle/generation/kuromoji.gradle
/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// This downloads and compiles Kuromoji dictionaries.

def recompileDictionary(project, dictionaryName, Closure closure) {
  project.javaexec {
    main = "org.apache.lucene.analysis.ja.util.DictionaryBuilder"
    classpath = project.sourceSets.main.runtimeClasspath

    jvmArgs '-Xmx1G'

    with closure
  }
  project.logger.lifecycle("Automaton regenerated from dictionary: ${dictionaryName}")
}

configure(project(":lucene:analysis:kuromoji")) {
  apply plugin: "de.undercouch.download"

  plugins.withType(JavaPlugin) {
    ext {
      targetDir = file("src/resources")
    }

    task deleteDictionaryData() {
      // There should really be just one but since we don't know which
      // one it'll be, let's process all of them.
      doFirst {
        sourceSets.main.resources.srcDirs.each { location ->
          delete fileTree(dir: location, include: "org/apache/lucene/analysis/ja/dict/*.dat")
        }
      }
    }

    task compileUnidic(type: Download) {
      description "Recompile dictionaries from UniDic data."
      group "generation"

      dependsOn deleteDictionaryData
      dependsOn sourceSets.main.runtimeClasspath

      def dictionaryVersion = "3.1.1"
      def dictionaryName = "unidic-cwj-${dictionaryVersion}-full.zip"
      def dictionarySource = "https://clrd.ninjal.ac.jp/unidic_archive/cwj/${dictionaryVersion}/${dictionaryName}"
      def dictionaryFile = file("${buildDir}/generate/${dictionaryName}.tar.gz")
      def unpackedDir = file("${buildDir}/generate/${dictionaryName}")

      src dictionarySource
      dest dictionaryFile
      onlyIfModified true

      doLast {
        // Unpack the downloaded archive.
        delete unpackedDir
        ant.unzip(src: dictionaryFile, dest: unpackedDir) {
          ant.cutdirsmapper(dirs: "1")
        }

        // Compile the dictionary
        recompileDictionary(project, dictionaryName, {
          args += [
              "unidic",
              unpackedDir,
              targetDir,
              "utf-8",
              false
          ]
        })
      }
    }

    regenerate.dependsOn compileUnidic
  }
}
```

#### `DictionaryBuilder.java`

69è¡Œç›®ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

```diff:lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/util/DictionaryBuilder.java
-new UnknownDictionaryBuilder(encoding).build(inputDir).write(outputDir);
+new UnknownDictionaryBuilder(format, encoding).build(inputDir).write(outputDir);
```

#### `TokenInfoDictionaryBuilder.java`

79è¡Œç›®ä»˜è¿‘ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

```diff:lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/util/TokenInfoDictionaryBuilder.java
-if (entry.length < 13) {
+if (this.format == DictionaryFormat.IPADIC && entry.length < 13) {
+  throw new IllegalArgumentException(
+     "Entry in CSV is not valid (13 field values expected): " + line);
+} else if (this.format == DictionaryFormat.UNIDIC && entry.length < 21) {
  throw new IllegalArgumentException(
      "Entry in CSV is not valid (13 field values expected): " + line);
}
```


ã¾ãŸã€179è¡Œç›®ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

```diff:lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/util/TokenInfoDictionaryBuilder.java
-features2[10] = features[11];
+features2[10] = features[14];
```

#### `UnknownDictionaryBuilder.java`

29~38è¡Œç›®ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

```diff:lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/util/UnknownDictionaryBuilder.java
import org.apache.lucene.analysis.ja.dict.CharacterDefinition;
+import org.apache.lucene.analysis.ja.util.DictionaryBuilder.DictionaryFormat;

class UnknownDictionaryBuilder {
  private static final String NGRAM_DICTIONARY_ENTRY = "NGRAM,5,5,-32768,è¨˜å·,ä¸€èˆ¬,*,*,*,*,*,*,*";

  private final String encoding;
+ private final DictionaryFormat format;

- UnknownDictionaryBuilder(String encoding) {
+ UnknownDictionaryBuilder(DictionaryFormat format, String encoding) {
+   this.format = format;
    this.encoding = encoding;
  }
```

ã¾ãŸã€68è¡Œç›®ä»˜è¿‘ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚


```diff:lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/util/UnknownDictionaryBuilder.java
-       final String[] parsed =
-           CSVUtil.parse(line + ",*,*"); // Probably we don't need to validate entry

+       final String[] parsed;
+       if (this.format == DictionaryFormat.UNIDIC) {
+         parsed = CSVUtil.parse(line + ",*,*,*"); // UniDic needs one more column
+       } else {
+         parsed = CSVUtil.parse(line + ",*,*"); // Probably we don't need to validate entry
+       }
```

#### `BinaryDictionaryWriter.java`

35è¡Œç›®ã€40~41è¡Œç›®ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

```diff:lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/util/BinaryDictionaryWriter.java
- private static final int ID_LIMIT = 8192;
+ private static final int ID_LIMIT = 16384;

  private final Class<? extends BinaryDictionary> implClazz;
  protected ByteBuffer buffer;
  private int targetMapEndOffset = 0, lastWordId = -1, lastSourceId = -1;
- private int[] targetMap = new int[8192];
+ private int[] targetMap = new int[16384];
- private int[] targetMapOffsets = new int[8192];
+ private int[] targetMapOffsets = new int[16384];
```

ã¾ãŸã€`IllegalArgumentException`ã‚’é€å‡ºã™ã‚‹ç®‡æ‰€ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¾ã™ã€‚

119~124è¡Œç›®ã€132~135è¡Œç›®ã€142~144è¡Œç›®ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¾ã™ã€‚

```diff:lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/util/BinaryDictionaryWriter.java
    // if (leftId != rightId) {
    //   throw new IllegalArgumentException("rightId != leftId: " + rightId + " " + leftId);
    // }
    // if (leftId >= ID_LIMIT) {
    //   throw new IllegalArgumentException("leftId >= " + ID_LIMIT + ": " + leftId);
    // }
```

```diff:lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/util/BinaryDictionaryWriter.java
    // if (existing != null && existing.equals(fullPOSData) == false) {
    //   // TODO: test me
    //   throw new IllegalArgumentException("Multiple entries found for leftID=" + leftId);
    // }
```

```diff:lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/util/BinaryDictionaryWriter.java
      // if (baseForm.length() >= 16) {
      //   throw new IllegalArgumentException("Length of base form " + baseForm + " is >= 16");
      // }
```

### è¾æ›¸ã®ãƒ“ãƒ«ãƒ‰

è¾æ›¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚`compileUnidic`ã‚¿ã‚¹ã‚¯å˜ä½“ã§ã‚‚å®Ÿè¡Œã§ãã¾ã™ãŒã€ã“ã‚Œã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸè¾æ›¸ã¯ã„ãã¤ã‹ã®å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚“ã§ã„ã¾ã›ã‚“ã€‚
å®Œå…¨ãªè¾æ›¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã«ã¯å…¨ä½“ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
./gradlew assemble
```

ãƒ“ãƒ«ãƒ‰ãŒå®Œäº†ã™ã‚‹ã¨ã€`lucene/analysis/kuromoji/build/libs`ä»¥ä¸‹ã«è¾æ›¸ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚ä½•ã‚‚è¨­å®šã‚’å¤‰æ›´ã—ã¦ã„ãªã‘ã‚Œã°ã€`lucene-analysis-kuromoji-9.3.0-SNAPSHOT.jar`ã¨ã„ã†åå‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚
ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒ422MBã«ãªã£ã¦ã„ã‚Œã°OKã§ã™ã€‚

### Solrã§ä½¿ç”¨ã™ã‚‹

`/opt/solr/server/solr-webapp/webapp/WEB-INF/lib`ä»¥ä¸‹ã«ã€ç”Ÿæˆã—ãŸè¾æ›¸ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’é…ç½®ã—ã¾ã™ã€‚

ã¾ãšã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹kuromojiè¾æ›¸ã‚’ç„¡åŠ¹åŒ–ã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯`lucene-analysis-kuromoji-9.3.0.jar`ã¨ã„ã†è¾æ›¸ãŒã‚ã‚‹ã®ã§ã€ã“ã‚Œã‚’å‰Šé™¤ã™ã‚‹ã‹ã€`lucene-analysis-kuromoji-9.3.0.jar.org`ã®ã‚ˆã†ã«ãƒªãƒãƒ¼ãƒ ã™ã‚‹ã‹ã—ã¾ã™ã€‚æ‹¡å¼µå­ãŒ`.jar`ã§ãªããªã‚Œã°ãªã‚“ã§ã‚‚ã‚ˆã„ã§ã™ã€‚

ãã—ã¦ã€ç”Ÿæˆã—ãŸè¾æ›¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ã¾ã™ã€‚

```bash
cp lucene/analysis/kuromoji/build/libs/lucene-analysis-kuromoji-9.3.0-SNAPSHOT.jar /opt/solr/server/solr-webapp/webapp/WEB-INF/lib/
```

Solrã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã®è¨­å®šã«ã‚ˆã£ã¦ã¯ã€`/opt/solr/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™ãŒsolrãƒ¦ãƒ¼ã‚¶ã«è¨­å®šã•ã‚Œã¦ã„ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ”ãƒ¼ãŒã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
ãã®å ´åˆã¯rootæ¨©é™ã§å®Ÿè¡Œã™ã‚‹ãªã©ã—ã¦å¯¾å‡¦ã—ã¦ãã ã•ã„ã€‚
(ç§ã¯Solrã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™ã‚’å…¨éƒ¨rootã«æ›¸ãæ›ãˆã¦ã—ã¾ã£ãŸã®ã§rootæ¨©é™ã§ã‚³ãƒ”ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹ã ã‘ã§ã§ãã¾ã—ãŸ)

è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ãŸã‚ã¨ã¯ã€ã‚³ã‚¢ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‹ã€Solræœ¬ä½“ã‚’å†èµ·å‹•ã—ã¾ã™ã€‚

### å‹•ä½œç¢ºèª

å‹•ä½œç¢ºèªã‚’ã—ã¾ã™ã€‚ä¾‹æ–‡ã¨ã—ã¦ã€Œè‡ªè»¢è»Šã¨è‡ªå‹•è»Šã®é•ã„ã¯ãªã‚“ã§ã—ã‚‡ã†ï¼Ÿã€ã‚’å½¢æ…‹ç´ è§£æã•ã›ã¦ã¿ã¾ã™ã€‚

![](/images/33a356a9267789/2022-12-26-18-35-03.png)

ã¡ã‚ƒã‚“ã¨UniDicã‚’ä½¿ã£ã¦å½¢æ…‹ç´ è§£æã—ã¦ãã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚